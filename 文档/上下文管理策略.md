# 上下文管理策略

## 🧠 理解上下文丢失的问题

### 为什么会出现上下文丢失？
1. **对话长度限制**：AI模型有token限制，超长对话会被截断
2. **新对话窗口**：开启新对话时，之前的所有上下文都会丢失
3. **信息碎片化**：项目信息散布在多个对话中，难以整合
4. **隐式知识丢失**：AI在开发过程中积累的项目理解无法传递

### 上下文丢失的后果
- AI不了解项目整体架构，做出不一致的决策
- 重复解释相同的概念和需求
- 修改代码时破坏已有的设计模式
- 引入与项目风格不符的代码
- 无法理解模块间的依赖关系

## 🛠️ Augment特有的上下文管理优势

### 1. 项目级记忆系统
```
优势：
- 记忆信息与项目文件夹绑定
- 跨对话保持项目上下文
- 自动学习和记住项目特点
```

### 2. 代码库理解能力
```
优势：
- 实时分析整个代码库
- 理解代码间的依赖关系
- 保持代码风格一致性
```

### 3. 智能上下文检索
```
优势：
- 根据当前任务自动检索相关信息
- 理解项目的整体架构
- 维护长期的项目知识
```

## 📚 建立项目知识库

### 1. 核心文档体系
```
项目根目录/
├── README.md                 # 项目总览
├── docs/
│   ├── 架构设计.md           # 系统架构文档
│   ├── API文档.md            # 接口文档
│   ├── 数据库设计.md         # 数据模型
│   ├── 开发规范.md           # 代码规范
│   └── 部署指南.md           # 部署文档
├── CHANGELOG.md              # 变更日志
└── TODO.md                   # 待办事项
```

### 2. README.md 标准模板
```markdown
# 项目名称

## 🎯 项目概述
[一句话描述项目目标]

## 🏗️ 技术架构
- 前端：[技术栈]
- 后端：[技术栈]
- 数据库：[数据库类型]
- 部署：[部署方式]

## 📁 项目结构
```
[项目目录结构]
```

## 🚀 快速开始
[安装和运行步骤]

## 📋 核心功能
- [功能1]：[简要描述]
- [功能2]：[简要描述]

## 🔗 相关文档
- [架构设计](docs/架构设计.md)
- [API文档](docs/API文档.md)
- [开发规范](docs/开发规范.md)

## 📝 开发日志
[记录重要的开发决策和变更]
```

### 3. 架构设计文档模板
```markdown
# 系统架构设计

## 整体架构
[系统架构图和说明]

## 模块划分
### 前端模块
- [模块1]：[职责和功能]
- [模块2]：[职责和功能]

### 后端模块
- [模块1]：[职责和功能]
- [模块2]：[职责和功能]

## 数据流设计
[数据在系统中的流转过程]

## 关键设计决策
- [决策1]：[原因和影响]
- [决策2]：[原因和影响]
```

## 🔄 有效的AI协作流程

### 1. 项目启动阶段
```
步骤1：创建项目文档
- 填写完整的需求分析
- 建立基础文档结构
- 确定技术方案

步骤2：与AI建立上下文
- 分享项目文档
- 要求AI记住关键信息
- 确认AI理解项目目标

步骤3：制定开发计划
- 拆分开发任务
- 确定优先级
- 建立里程碑
```

### 2. 开发过程中
```
每次与AI对话前：
1. 简要说明当前任务的背景
2. 引用相关的文档和代码
3. 明确当前的开发阶段

每次完成功能后：
1. 更新相关文档
2. 要求AI记住重要变更
3. 提交代码并写清楚commit信息
```

### 3. 新对话开始时
```
标准开场白模板：
"我正在开发[项目名称]，这是一个[项目类型]。
项目的核心目标是[核心目标]。
当前技术栈：[技术栈列表]
项目进展：[当前阶段]
今天我需要：[具体任务]

请先查看项目的README.md和相关文档，确认你了解项目背景后，我们开始今天的开发任务。"
```

## 💾 使用Augment记忆功能

### 1. 什么信息需要记住？
```
项目级信息：
- 项目目标和核心功能
- 技术架构和设计决策
- 代码规范和风格指南
- 重要的配置信息

开发过程信息：
- 已完成的功能模块
- 当前的开发进度
- 遇到的问题和解决方案
- 重要的代码模式和约定
```

### 2. 记忆信息的最佳实践
```
格式化记忆内容：
"请记住：[项目名称]使用[技术栈]，核心功能包括[功能列表]，当前已完成[进度描述]"

定期更新记忆：
- 每完成一个重要功能后更新进度
- 做出重要技术决策时记录原因
- 遇到复杂问题时记录解决方案
```

### 3. 记忆内容示例
```
项目初始化时：
"请记住：TaskManager项目是一个基于React+Node.js的任务管理系统，主要功能包括用户认证、任务CRUD、团队协作。使用MongoDB存储数据，采用JWT认证，部署在Docker容器中。"

功能完成时：
"请记住：TaskManager项目已完成用户认证模块，包括注册、登录、JWT token管理。下一步要开发任务管理模块。"

技术决策时：
"请记住：TaskManager项目选择使用Redux Toolkit进行状态管理，因为需要复杂的状态共享。API使用RESTful设计，所有接口都有统一的错误处理。"
```

## 🔧 代码级上下文管理

### 1. 代码注释规范
```javascript
/**
 * 用户认证服务
 * 
 * 核心功能：
 * - JWT token生成和验证
 * - 用户登录状态管理
 * - 权限检查
 * 
 * 依赖：
 * - jsonwebtoken库
 * - User模型
 * 
 * 使用示例：
 * const token = AuthService.generateToken(user);
 */
class AuthService {
  // 实现代码...
}
```

### 2. 文件头部说明
```javascript
/**
 * 文件：src/services/AuthService.js
 * 作用：处理用户认证相关的业务逻辑
 * 创建：2024-01-15
 * 修改：2024-01-20 - 添加了密码重置功能
 * 
 * 相关文件：
 * - src/models/User.js (用户模型)
 * - src/controllers/AuthController.js (认证控制器)
 * - src/middleware/auth.js (认证中间件)
 */
```

### 3. 重要函数的文档
```javascript
/**
 * 生成JWT访问令牌
 * 
 * @param {Object} user - 用户对象
 * @param {string} user.id - 用户ID
 * @param {string} user.email - 用户邮箱
 * @param {string} user.role - 用户角色
 * @returns {string} JWT令牌
 * 
 * @example
 * const token = generateAccessToken({
 *   id: '123',
 *   email: 'user@example.com',
 *   role: 'user'
 * });
 */
function generateAccessToken(user) {
  // 实现代码...
}
```

## 📊 项目进度跟踪

### 1. 使用TODO.md跟踪任务
```markdown
# 项目待办事项

## 🚧 进行中
- [ ] 实现用户认证API
  - [x] 注册接口
  - [x] 登录接口
  - [ ] 密码重置接口

## ✅ 已完成
- [x] 项目初始化
- [x] 数据库设计
- [x] 基础框架搭建

## 📋 待开始
- [ ] 任务管理模块
- [ ] 团队协作功能
- [ ] 通知系统

## 🐛 已知问题
- [ ] 登录接口偶尔超时
- [ ] 前端路由刷新404
```

### 2. 使用CHANGELOG.md记录变更
```markdown
# 变更日志

## [未发布]
### 新增
- 用户注册和登录功能
- JWT认证中间件

### 修改
- 优化数据库连接池配置

### 修复
- 修复用户邮箱验证bug

## [0.1.0] - 2024-01-15
### 新增
- 项目初始化
- 基础框架搭建
```

## 🚨 避免常见陷阱

### 1. 信息过载
```
问题：一次性给AI太多信息
解决：分层次提供信息，先概述再详细

错误示例：
"这是我的整个项目代码[粘贴大量代码]，帮我添加一个功能"

正确示例：
"我的项目是一个任务管理系统，使用React+Node.js。我需要在现有的用户模块基础上添加密码重置功能。相关的代码文件是..."
```

### 2. 上下文不连贯
```
问题：每次对话都从零开始解释
解决：建立标准的对话开场白

标准开场白：
"继续开发[项目名称]，上次我们完成了[上次的工作]，今天需要[今天的任务]。项目使用[技术栈]，当前进度是[进度描述]。"
```

### 3. 文档不同步
```
问题：代码变更后忘记更新文档
解决：建立文档更新检查清单

每次提交代码前检查：
- [ ] README.md是否需要更新
- [ ] API文档是否需要更新
- [ ] 架构文档是否需要更新
- [ ] TODO.md是否需要更新
```

## ✅ 上下文管理检查清单

### 项目启动时
- [ ] 创建完整的项目文档
- [ ] 与AI建立项目上下文
- [ ] 要求AI记住关键信息
- [ ] 确认AI理解项目目标

### 开发过程中
- [ ] 每次对话前提供背景信息
- [ ] 完成功能后更新文档
- [ ] 定期要求AI记住重要变更
- [ ] 保持代码注释的完整性

### 新对话开始时
- [ ] 使用标准开场白
- [ ] 引用相关文档
- [ ] 说明当前进度
- [ ] 明确今天的任务

### 项目完成后
- [ ] 整理完整的项目文档
- [ ] 记录重要的经验教训
- [ ] 为未来的维护留下清晰的指南
