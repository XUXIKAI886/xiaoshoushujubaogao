<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½¬åŒ–æ¼æ–—æ•°æ®æµ‹è¯• - ç¾å›¢å¤–å–æ•°æ®åˆ†æ</title>
    
    <!-- Tailwind CSS + DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <style>
        .upload-area {
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #3B82F6;
            background-color: #EFF6FF;
        }
        .upload-area.dragover {
            border-color: #1D4ED8;
            background-color: #DBEAFE;
        }
        .chart-container {
            width: 100%;
            height: 400px;
        }
    </style>
</head>
<body class="bg-base-200 min-h-screen">
    <!-- å¯¼èˆªæ  -->
    <div class="navbar bg-base-100 shadow-lg">
        <div class="flex-1">
            <a class="btn btn-ghost text-xl">ğŸ“Š è½¬åŒ–æ¼æ–—æ•°æ®æµ‹è¯•</a>
        </div>
        <div class="flex-none">
            <div class="flex items-center space-x-2">
                <!-- æ¨¡å¼åˆ‡æ¢ -->
                <div class="form-control">
                    <label class="label cursor-pointer">
                        <span class="label-text mr-2">çœŸå®AIåˆ†æ</span>
                        <input type="checkbox" id="realAnalysisMode" class="toggle toggle-primary" checked />
                    </label>
                </div>
                <a href="index.html" class="btn btn-outline btn-sm">è¿”å›ä¸»é¡µ</a>
            </div>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        
        <!-- è¯´æ˜å¡ç‰‡ -->
        <div class="card bg-base-100 shadow-xl mb-8">
            <div class="card-body">
                <h2 class="card-title text-2xl mb-4">ğŸ¯ è½¬åŒ–æ¼æ–—æ•°æ®æµ‹è¯•è¯´æ˜</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-semibold text-lg mb-2">ğŸ“‹ æ”¯æŒçš„æ•°æ®æ ¼å¼</h3>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            <li><strong>å·¦ä¾§é»„è‰²åŒºåŸŸ</strong>ï¼šæœ¬åº—é“ºæ•°æ®</li>
                            <li>ç¬¬ä¸€åˆ—ï¼šå…¥åº—è½¬åŒ–ç‡ã€ä¸‹å•è½¬åŒ–ç‡</li>
                            <li>ç¬¬äºŒåˆ—ï¼šæ›å…‰äººæ•°ã€å…¥åº—äººæ•°ã€ä¸‹å•äººæ•°</li>
                            <li><strong>å³ä¾§è“è‰²åŒºåŸŸ</strong>ï¼šåŒè¡Œå‡å€¼æ•°æ®</li>
                            <li>ç¬¬ä¸€åˆ—ï¼šæ›å…‰äººæ•°ã€å…¥åº—äººæ•°ã€ä¸‹å•äººæ•°</li>
                            <li>ç¬¬äºŒåˆ—ï¼šå…¥åº—è½¬åŒ–ç‡ã€ä¸‹å•è½¬åŒ–ç‡</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg mb-2">ğŸ” AIå°†æå–çš„æ•°æ®</h3>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            <li>æœ¬åº—ä¸åŒè¡Œçš„è½¬åŒ–ç‡å¯¹æ¯”</li>
                            <li>æµé‡æ•°æ®ï¼ˆæ›å…‰ã€å…¥åº—ã€ä¸‹å•ï¼‰</li>
                            <li>è½¬åŒ–æ¼æ–—åˆ†æ</li>
                            <li>ç«äº‰åœ°ä½è¯„ä¼°</li>
                            <li>ä¼˜åŒ–å»ºè®®å’Œè¡ŒåŠ¨è®¡åˆ’</li>
                        </ul>

                        <div class="mt-4 p-3 bg-info/10 rounded-lg">
                            <h4 class="font-semibold text-sm mb-1">ğŸ’¡ åˆ†ææ¨¡å¼è¯´æ˜</h4>
                            <p class="text-xs text-gray-600">
                                â€¢ <strong>çœŸå®AIåˆ†æ</strong>ï¼šè°ƒç”¨Gemini APIè¿›è¡Œå®é™…åˆ†æ<br>
                                â€¢ <strong>æ¼”ç¤ºæ¨¡å¼</strong>ï¼šä½¿ç”¨é¢„è®¾æ•°æ®å¿«é€Ÿä½“éªŒåŠŸèƒ½<br>
                                â€¢ å¯åœ¨å³ä¸Šè§’åˆ‡æ¢åˆ†ææ¨¡å¼
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åº—é“ºä¿¡æ¯è¾“å…¥ -->
        <div class="card bg-base-100 shadow-xl mb-8">
            <div class="card-body">
                <h2 class="card-title text-xl mb-4">ğŸª åº—é“ºåŸºæœ¬ä¿¡æ¯</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">åº—é“ºåç§°</span>
                        </label>
                        <input type="text" id="storeName" placeholder="è¯·è¾“å…¥åº—é“ºåç§°"
                               class="input input-bordered" value="æµ‹è¯•åº—é“º">
                    </div>
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">ç»è¥å“ç±»</span>
                        </label>
                        <input type="text" id="storeCategory" placeholder="è¯·è¾“å…¥ç»è¥å“ç±»"
                               class="input input-bordered" value="ä¸­å¼å¿«é¤">
                    </div>
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">åº—é“ºåœ°å€</span>
                        </label>
                        <input type="text" id="storeAddress" placeholder="è¯·è¾“å…¥åº—é“ºåœ°å€"
                               class="input input-bordered" value="åŒ—äº¬å¸‚æœé˜³åŒº">
                    </div>
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">æ•°æ®æ—¶é—´èŒƒå›´</span>
                        </label>
                        <input type="text" id="dataDateRange" placeholder="2025-06-12 è‡³ 2025-07-11"
                               class="input input-bordered" value="2025-06-12 è‡³ 2025-07-11">
                    </div>
                </div>
            </div>
        </div>

        <!-- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
        <div class="card bg-base-100 shadow-xl mb-8">
            <div class="card-body">
                <h2 class="card-title text-xl mb-4">ğŸ“¸ ä¸Šä¼ è½¬åŒ–æ¼æ–—æˆªå›¾</h2>
                
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer" 
                     id="uploadArea" onclick="document.getElementById('imageUpload').click()">
                    <input type="file" id="imageUpload" accept="image/jpeg,image/png,image/webp" class="hidden">
                    <div class="upload-content" id="uploadContent">
                        <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                        </svg>
                        <p class="text-lg font-semibold text-gray-700 mb-2">ä¸Šä¼ è½¬åŒ–æ¼æ–—æˆªå›¾</p>
                        <p class="text-sm text-gray-500">æ”¯æŒ JPG, PNG, WEBP æ ¼å¼ï¼Œæœ€å¤§ 10MB</p>
                    </div>
                </div>
                
                <div class="preview-area hidden mt-6" id="previewArea">
                    <h3 class="text-lg font-semibold mb-4">å›¾ç‰‡é¢„è§ˆ</h3>
                    <div class="flex justify-center">
                        <img id="imagePreview" class="max-w-full max-h-96 rounded-lg shadow-lg">
                    </div>
                    <div class="text-center mt-4 space-x-2">
                        <button class="btn btn-outline btn-sm" onclick="removeImage()">é‡æ–°é€‰æ‹©</button>
                        <button class="btn btn-primary btn-sm" id="analyzeBtn" onclick="startFunnelAnalysis()" disabled>
                            å¼€å§‹åˆ†æè½¬åŒ–æ¼æ–—
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="showDemoResult()">
                            æŸ¥çœ‹æ¼”ç¤ºç»“æœ
                        </button>
                        <button class="btn btn-info btn-sm" onclick="testAPIConnection()">
                            æµ‹è¯•APIè¿æ¥
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- åˆ†æç»“æœå±•ç¤ºåŒºåŸŸ -->
        <div class="hidden" id="resultSection">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title text-xl mb-4">ğŸ“Š è½¬åŒ–æ¼æ–—åˆ†æç»“æœ</h2>
                    <div id="resultContent">
                        <!-- åˆ†æç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>
            </div>
        </div>

        <!-- åŠ è½½çŠ¶æ€ -->
        <div class="hidden" id="loadingSection">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body text-center">
                    <div class="loading loading-spinner loading-lg mb-4"></div>
                    <p class="text-lg">AIæ­£åœ¨åˆ†æè½¬åŒ–æ¼æ–—æ•°æ®...</p>
                    <p class="text-sm text-gray-500 mt-2">è¿™å¯èƒ½éœ€è¦20-40ç§’æ—¶é—´</p>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/chart.js"></script>
    <script src="js/demo-data.js"></script>
    
    <script>
        let uploadedImage = null;
        
        // å›¾ç‰‡ä¸Šä¼ å¤„ç†
        document.getElementById('imageUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                handleImageUpload(file);
            }
        });
        
        // æ‹–æ‹½ä¸Šä¼ 
        const uploadArea = document.getElementById('uploadArea');
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleImageUpload(files[0]);
            }
        });
        
        async function handleImageUpload(file) {
            try {
                const validation = validateFile(file);
                if (!validation.valid) {
                    alert(validation.errors.join('\n'));
                    return;
                }
                
                const base64 = await fileToBase64(file);
                uploadedImage = { file, base64, name: file.name, size: file.size };
                
                // æ˜¾ç¤ºé¢„è§ˆ
                const previewArea = document.getElementById('previewArea');
                const imagePreview = document.getElementById('imagePreview');
                imagePreview.src = base64;
                previewArea.classList.remove('hidden');
                
                // å¯ç”¨åˆ†ææŒ‰é’®
                document.getElementById('analyzeBtn').disabled = false;
                
                // æ›´æ–°ä¸Šä¼ åŒºåŸŸæ˜¾ç¤º
                document.getElementById('uploadContent').innerHTML = `
                    <svg class="mx-auto h-16 w-16 text-green-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <p class="text-lg font-semibold text-green-700 mb-2">å›¾ç‰‡ä¸Šä¼ æˆåŠŸ</p>
                    <p class="text-sm text-gray-500">æ–‡ä»¶å¤§å°: ${formatFileSize(file.size)}</p>
                `;
                
            } catch (error) {
                console.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥:', error);
                alert('å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }
        
        function removeImage() {
            uploadedImage = null;
            document.getElementById('previewArea').classList.add('hidden');
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('imageUpload').value = '';
            
            document.getElementById('uploadContent').innerHTML = `
                <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p class="text-lg font-semibold text-gray-700 mb-2">ä¸Šä¼ è½¬åŒ–æ¼æ–—æˆªå›¾</p>
                <p class="text-sm text-gray-500">æ”¯æŒ JPG, PNG, WEBP æ ¼å¼ï¼Œæœ€å¤§ 10MB</p>
            `;
        }
        
        async function startFunnelAnalysis() {
            if (!uploadedImage) {
                alert('è¯·å…ˆä¸Šä¼ å›¾ç‰‡');
                return;
            }

            // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨çœŸå®AIåˆ†æ
            const useRealAnalysis = document.getElementById('realAnalysisMode').checked;

            if (!useRealAnalysis) {
                // ä½¿ç”¨æ¼”ç¤ºæ•°æ®
                console.log('ä½¿ç”¨æ¼”ç¤ºæ¨¡å¼åˆ†æ...');
                displayFunnelResult(CONVERSION_FUNNEL_DEMO);
                return;
            }

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loadingSection').classList.remove('hidden');
            document.getElementById('resultSection').classList.add('hidden');

            try {
                const storeInfo = {
                    name: document.getElementById('storeName').value,
                    category: document.getElementById('storeCategory').value,
                    address: document.getElementById('storeAddress').value,
                    dateRange: document.getElementById('dataDateRange').value || '30å¤©æ•°æ®'
                };

                // åˆ›å»ºä¸€ä¸ªæ–°çš„APIå®ä¾‹ï¼Œç¡®ä¿ä¸è¢«æ¼”ç¤ºæ¨¡å¼å½±å“
                const realAPI = new GeminiAPI();

                // è°ƒç”¨çœŸå®çš„AIåˆ†æ
                console.log('å¼€å§‹çœŸå®AIåˆ†æ...');
                const result = await realAPI.analyzeImage(uploadedImage.base64, storeInfo);

                // éšè—åŠ è½½çŠ¶æ€
                document.getElementById('loadingSection').classList.add('hidden');

                if (result.error) {
                    throw new Error(result.error + (result.rawText ? '\nåŸå§‹å“åº”: ' + result.rawText : ''));
                }

                console.log('AIåˆ†æç»“æœ:', result);

                // æ˜¾ç¤ºç»“æœ
                displayFunnelResult(result);

            } catch (error) {
                console.error('åˆ†æå¤±è´¥:', error);
                document.getElementById('loadingSection').classList.add('hidden');

                // æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
                const errorMsg = `åˆ†æå¤±è´¥: ${error.message}\n\nå¯èƒ½çš„åŸå› ï¼š\n1. ç½‘ç»œè¿æ¥é—®é¢˜\n2. APIé…ç½®é”™è¯¯\n3. å›¾ç‰‡æ ¼å¼ä¸æ”¯æŒ\n4. AIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨\n\nå»ºè®®ï¼šå¯ä»¥å…³é—­"çœŸå®AIåˆ†æ"å¼€å…³ä½¿ç”¨æ¼”ç¤ºæ¨¡å¼æµ‹è¯•åŠŸèƒ½ã€‚`;
                alert(errorMsg);
            }
        }
        
        function displayFunnelResult(result) {
            const resultContent = document.getElementById('resultContent');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰è½¬åŒ–æ¼æ–—æ•°æ®
            if (result.extractedData && result.extractedData.conversionFunnel) {
                const funnel = result.extractedData.conversionFunnel;
                
                resultContent.innerHTML = `
                    <div class="space-y-6">
                        <div class="stats shadow w-full">
                            <div class="stat">
                                <div class="stat-title">æ•°æ®å‘¨æœŸ</div>
                                <div class="stat-value text-primary">${funnel.dataPeriod || '30å¤©'}</div>
                            </div>
                            <div class="stat">
                                <div class="stat-title">æœ¬åº—å…¥åº—è½¬åŒ–ç‡</div>
                                <div class="stat-value text-secondary">${funnel.storeData.visitRate || 'N/A'}</div>
                            </div>
                            <div class="stat">
                                <div class="stat-title">æœ¬åº—ä¸‹å•è½¬åŒ–ç‡</div>
                                <div class="stat-value text-accent">${funnel.storeData.orderRate || 'N/A'}</div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="card bg-base-200">
                                <div class="card-body">
                                    <h3 class="card-title">æœ¬åº—æ•°æ®</h3>
                                    <div class="space-y-2">
                                        <p><strong>æ›å…‰äººæ•°:</strong> ${funnel.storeData.exposure || 'N/A'}</p>
                                        <p><strong>å…¥åº—äººæ•°:</strong> ${funnel.storeData.visits || 'N/A'}</p>
                                        <p><strong>ä¸‹å•äººæ•°:</strong> ${funnel.storeData.orders || 'N/A'}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card bg-base-200">
                                <div class="card-body">
                                    <h3 class="card-title">åŒè¡Œå‡å€¼</h3>
                                    <div class="space-y-2">
                                        <p><strong>æ›å…‰äººæ•°:</strong> ${funnel.industryAverage.exposure || 'N/A'}</p>
                                        <p><strong>å…¥åº—äººæ•°:</strong> ${funnel.industryAverage.visits || 'N/A'}</p>
                                        <p><strong>ä¸‹å•äººæ•°:</strong> ${funnel.industryAverage.orders || 'N/A'}</p>
                                        <p><strong>å…¥åº—è½¬åŒ–ç‡:</strong> ${funnel.industryAverage.visitRate || 'N/A'}</p>
                                        <p><strong>ä¸‹å•è½¬åŒ–ç‡:</strong> ${funnel.industryAverage.orderRate || 'N/A'}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        ${funnel.comparison ? `
                        <div class="card bg-base-200">
                            <div class="card-body">
                                <h3 class="card-title">å¯¹æ¯”åˆ†æ</h3>
                                <div class="space-y-2">
                                    <p><strong>æ›å…‰å·®è·:</strong> ${funnel.comparison.exposureGap || 'N/A'}</p>
                                    <p><strong>è½¬åŒ–ç‡å·®è·:</strong> ${funnel.comparison.conversionGap || 'N/A'}</p>
                                    <p><strong>ç«äº‰åœ°ä½:</strong> ${funnel.comparison.competitivePosition || 'N/A'}</p>
                                </div>
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="card bg-base-200">
                            <div class="card-body">
                                <h3 class="card-title">å®Œæ•´åˆ†æç»“æœ</h3>
                                <pre class="text-xs overflow-auto bg-base-300 p-4 rounded">${JSON.stringify(result, null, 2)}</pre>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                resultContent.innerHTML = `
                    <div class="alert alert-warning">
                        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z" />
                        </svg>
                        <span>æœªæ£€æµ‹åˆ°è½¬åŒ–æ¼æ–—æ•°æ®æ ¼å¼ï¼Œæ˜¾ç¤ºåŸå§‹åˆ†æç»“æœ</span>
                    </div>
                    <pre class="text-xs overflow-auto bg-base-300 p-4 rounded mt-4">${JSON.stringify(result, null, 2)}</pre>
                `;
            }
            
            document.getElementById('resultSection').classList.remove('hidden');
        }

        // æ˜¾ç¤ºæ¼”ç¤ºç»“æœ
        function showDemoResult() {
            if (typeof CONVERSION_FUNNEL_DEMO !== 'undefined') {
                displayFunnelResult(CONVERSION_FUNNEL_DEMO);
            } else {
                alert('æ¼”ç¤ºæ•°æ®æœªåŠ è½½');
            }
        }

        // æµ‹è¯•APIè¿æ¥
        async function testAPIConnection() {
            try {
                console.log('å¼€å§‹æµ‹è¯•APIè¿æ¥...');
                const testAPI = new GeminiAPI();

                // æ˜¾ç¤ºæµ‹è¯•çŠ¶æ€
                const loadingSection = document.getElementById('loadingSection');
                const loadingText = loadingSection.querySelector('p');
                const originalText = loadingText.textContent;

                loadingSection.classList.remove('hidden');
                loadingText.textContent = 'æ­£åœ¨æµ‹è¯•APIè¿æ¥...';

                const result = await testAPI.testConnection();

                loadingSection.classList.add('hidden');
                loadingText.textContent = originalText;

                if (result.success) {
                    alert('âœ… APIè¿æ¥æˆåŠŸï¼\n\nå¯ä»¥æ­£å¸¸ä½¿ç”¨çœŸå®AIåˆ†æåŠŸèƒ½ã€‚');
                    console.log('APIè¿æ¥æµ‹è¯•æˆåŠŸ:', result);
                } else {
                    let errorMsg = 'âŒ APIè¿æ¥å¤±è´¥ï¼\n\n';
                    errorMsg += `é”™è¯¯ä¿¡æ¯: ${result.error}\n\n`;

                    if (result.details.status) {
                        errorMsg += `HTTPçŠ¶æ€: ${result.details.status} ${result.details.statusText}\n\n`;
                    }

                    if (result.suggestions.length > 0) {
                        errorMsg += 'å»ºè®®è§£å†³æ–¹æ¡ˆ:\n';
                        result.suggestions.forEach((suggestion, index) => {
                            errorMsg += `${index + 1}. ${suggestion}\n`;
                        });
                        errorMsg += '\n';
                    }

                    errorMsg += 'ä¸´æ—¶è§£å†³æ–¹æ¡ˆ:\n';
                    errorMsg += 'â€¢ å…³é—­"çœŸå®AIåˆ†æ"å¼€å…³ä½¿ç”¨æ¼”ç¤ºæ¨¡å¼\n';
                    errorMsg += 'â€¢ æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®\n';
                    errorMsg += 'â€¢ ç¨åé‡è¯•æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ';

                    alert(errorMsg);
                    console.log('APIè¿æ¥æµ‹è¯•å¤±è´¥:', result);
                }

            } catch (error) {
                document.getElementById('loadingSection').classList.add('hidden');
                console.error('APIè¿æ¥æµ‹è¯•å‡ºé”™:', error);
                alert('âŒ APIè¿æ¥æµ‹è¯•å‡ºé”™ï¼\n\né”™è¯¯ä¿¡æ¯: ' + error.message + '\n\nå»ºè®®ä½¿ç”¨æ¼”ç¤ºæ¨¡å¼æµ‹è¯•åŠŸèƒ½ã€‚');
            }
        }
    </script>
</body>
</html>
