<!DOCTYPE html>
<html lang="zh-CN" data-theme="light" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾è¡¨æµ‹è¯•é¡µé¢</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body class="bg-base-200 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="card bg-base-100 shadow-xl mb-8">
            <div class="card-body">
                <h1 class="card-title text-2xl mb-6">ğŸ“Š å›¾è¡¨ç”Ÿæˆæµ‹è¯•</h1>
                
                <div class="flex gap-4 mb-6 flex-wrap">
                    <button class="btn btn-primary" onclick="testAllCharts()">æµ‹è¯•æ‰€æœ‰å›¾è¡¨</button>
                    <button class="btn btn-secondary" onclick="testDemoReport()">æµ‹è¯•æ¼”ç¤ºæŠ¥å‘Š</button>
                    <button class="btn btn-accent" onclick="clearCharts()">æ¸…ç©ºå›¾è¡¨</button>
                    <button class="btn btn-outline" onclick="toggleChartTheme()">åˆ‡æ¢ä¸»é¢˜</button>
                </div>
                
                <div id="chartCount" class="text-lg font-semibold mb-4"></div>
                
                <!-- å›¾è¡¨å®¹å™¨ -->
                <div id="chartsContainer" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                    <!-- å›¾è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
        
        <!-- æµ‹è¯•æ—¥å¿— -->
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title">æµ‹è¯•æ—¥å¿—</h2>
                <div id="testLog" class="bg-base-300 rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm">
                    <p class="text-gray-500">ç‚¹å‡»æµ‹è¯•æŒ‰é’®å¼€å§‹...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥JavaScriptæ–‡ä»¶ -->
    <script src="js/utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/chart.js"></script>
    <script src="js/demo-data.js"></script>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = {
                'success': 'text-green-600',
                'error': 'text-red-600',
                'warning': 'text-yellow-600',
                'info': 'text-blue-600'
            }[type] || 'text-gray-600';
            
            logDiv.innerHTML += `<div class="${colorClass}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateChartCount(count) {
            document.getElementById('chartCount').textContent = `å½“å‰æ˜¾ç¤º ${count} ä¸ªå›¾è¡¨`;
        }

        function clearCharts() {
            const container = document.getElementById('chartsContainer');
            container.innerHTML = '';
            chartGenerator.destroyAllCharts();
            updateChartCount(0);
            log('ğŸ—‘ï¸ å·²æ¸…ç©ºæ‰€æœ‰å›¾è¡¨', 'info');
        }

        function testAllCharts() {
            log('ğŸš€ å¼€å§‹æµ‹è¯•æ‰€æœ‰å›¾è¡¨ç±»å‹...', 'info');
            clearCharts();
            
            const testCharts = [
                {
                    type: 'bar',
                    title: 'æµ‹è¯•æŸ±çŠ¶å›¾',
                    description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æŸ±çŠ¶å›¾',
                    data: {
                        categories: ['A', 'B', 'C', 'D'],
                        values: [120, 200, 150, 80],
                        unit: 'ä»¶'
                    }
                },
                {
                    type: 'line',
                    title: 'æµ‹è¯•æŠ˜çº¿å›¾',
                    description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æŠ˜çº¿å›¾',
                    data: {
                        dates: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ'],
                        values: [100, 120, 140, 110],
                        unit: 'å•'
                    }
                },
                {
                    type: 'pie',
                    title: 'æµ‹è¯•é¥¼å›¾',
                    description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¥¼å›¾',
                    data: {
                        items: [
                            { name: 'ç±»åˆ«A', value: 35 },
                            { name: 'ç±»åˆ«B', value: 25 },
                            { name: 'ç±»åˆ«C', value: 20 },
                            { name: 'ç±»åˆ«D', value: 20 }
                        ]
                    }
                },
                {
                    type: 'radar',
                    title: 'æµ‹è¯•é›·è¾¾å›¾',
                    description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é›·è¾¾å›¾',
                    data: {
                        indicators: [
                            { name: 'æŒ‡æ ‡1', max: 100 },
                            { name: 'æŒ‡æ ‡2', max: 100 },
                            { name: 'æŒ‡æ ‡3', max: 100 },
                            { name: 'æŒ‡æ ‡4', max: 100 },
                            { name: 'æŒ‡æ ‡5', max: 100 }
                        ],
                        values: [80, 90, 70, 85, 75]
                    }
                },
                {
                    type: 'gauge',
                    title: 'æµ‹è¯•ä»ªè¡¨ç›˜',
                    description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ä»ªè¡¨ç›˜',
                    data: {
                        value: 75,
                        max: 100
                    }
                },
                {
                    type: 'bar',
                    title: 'æµ‹è¯•ç¬¬äºŒä¸ªæŸ±çŠ¶å›¾',
                    description: 'è¿™æ˜¯ç¬¬äºŒä¸ªæŸ±çŠ¶å›¾',
                    data: {
                        categories: ['äº§å“1', 'äº§å“2', 'äº§å“3'],
                        values: [300, 250, 180],
                        unit: 'é”€é‡'
                    }
                }
            ];

            const container = document.getElementById('chartsContainer');
            
            testCharts.forEach((chartData, index) => {
                // åˆ›å»ºå›¾è¡¨å®¹å™¨
                const chartDiv = document.createElement('div');
                chartDiv.className = 'bg-gray-50 rounded-lg p-4';
                chartDiv.innerHTML = `
                    <h3 class="text-lg font-semibold mb-2 text-gray-700">${chartData.title}</h3>
                    <p class="text-sm text-gray-600 mb-4">${chartData.description}</p>
                    <div id="test-chart-${index}" style="width: 100%; height: 350px;"></div>
                `;
                container.appendChild(chartDiv);
                
                // å»¶è¿Ÿæ¸²æŸ“å›¾è¡¨
                setTimeout(() => {
                    log(`ğŸ“Š æ­£åœ¨æ¸²æŸ“: ${chartData.title} (${chartData.type})`, 'info');
                    const chart = chartGenerator.generateChart(`test-chart-${index}`, chartData);
                    if (chart) {
                        log(`âœ… æˆåŠŸæ¸²æŸ“: ${chartData.title}`, 'success');
                    } else {
                        log(`âŒ æ¸²æŸ“å¤±è´¥: ${chartData.title}`, 'error');
                    }
                }, 200 * index);
            });
            
            updateChartCount(testCharts.length);
            log(`ğŸ“ˆ å‡†å¤‡æ¸²æŸ“ ${testCharts.length} ä¸ªå›¾è¡¨`, 'info');
        }

        function testDemoReport() {
            log('ğŸ­ å¼€å§‹æµ‹è¯•æ¼”ç¤ºæ•°æ®å›¾è¡¨...', 'info');
            clearCharts();
            
            if (typeof DEMO_ANALYSIS_DATA === 'undefined') {
                log('âŒ æ¼”ç¤ºæ•°æ®æœªåŠ è½½', 'error');
                return;
            }
            
            const demoCharts = DEMO_ANALYSIS_DATA.charts || [];
            log(`ğŸ“Š æ¼”ç¤ºæ•°æ®åŒ…å« ${demoCharts.length} ä¸ªå›¾è¡¨`, 'info');
            
            const container = document.getElementById('chartsContainer');
            
            demoCharts.forEach((chartData, index) => {
                // åˆ›å»ºå›¾è¡¨å®¹å™¨
                const chartDiv = document.createElement('div');
                chartDiv.className = 'bg-gray-50 rounded-lg p-4';
                chartDiv.innerHTML = `
                    <h3 class="text-lg font-semibold mb-2 text-gray-700">${chartData.title}</h3>
                    <p class="text-sm text-gray-600 mb-4">${chartData.description}</p>
                    <div id="demo-chart-${index}" style="width: 100%; height: 350px;"></div>
                `;
                container.appendChild(chartDiv);
                
                // å»¶è¿Ÿæ¸²æŸ“å›¾è¡¨
                setTimeout(() => {
                    log(`ğŸ“Š æ­£åœ¨æ¸²æŸ“æ¼”ç¤ºå›¾è¡¨: ${chartData.title} (${chartData.type})`, 'info');
                    const chart = chartGenerator.generateChart(`demo-chart-${index}`, chartData);
                    if (chart) {
                        log(`âœ… æ¼”ç¤ºå›¾è¡¨æ¸²æŸ“æˆåŠŸ: ${chartData.title}`, 'success');
                    } else {
                        log(`âŒ æ¼”ç¤ºå›¾è¡¨æ¸²æŸ“å¤±è´¥: ${chartData.title}`, 'error');
                    }
                }, 200 * index);
            });
            
            updateChartCount(demoCharts.length);
        }

        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        function toggleChartTheme() {
            if (typeof themeManager !== 'undefined') {
                themeManager.toggleTheme();
                log('ğŸ¨ ä¸»é¢˜å·²åˆ‡æ¢', 'info');
            } else {
                // ç®€å•çš„ä¸»é¢˜åˆ‡æ¢
                const htmlRoot = document.getElementById('htmlRoot');
                const currentTheme = htmlRoot.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                htmlRoot.setAttribute('data-theme', newTheme);
                log(`ğŸ¨ ä¸»é¢˜å·²åˆ‡æ¢è‡³: ${newTheme}`, 'info');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ å›¾è¡¨æµ‹è¯•é¡µé¢å·²åŠ è½½', 'success');
            updateChartCount(0);
        });
    </script>
</body>
</html>
